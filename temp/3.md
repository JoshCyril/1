# Technical Implementation Plan for Full-Stack Attendance Tracking Application in a Single Docker Container

> - The application will use React with TanStack (React Query) for the frontend, Node.js (Express) for the backend, and SQLite for the database, all containerized in Docker.  
> - Real-time data filtering, graph rendering, and authentication will be supported without external dependencies.  
> - A multi-stage Dockerfile will install dependencies, build frontend and backend, initialize the database with pre-filled data, and expose necessary ports.  
> - Secure user authentication will be implemented with JWT, hashed passwords, and environment variables for sensitive data.  
> - Comprehensive testing and deployment workflows ensure robust operation and easy maintenance.

---

## System Architecture

The application architecture consists of three main components: frontend, backend, and database, all running within a single Docker container. The frontend is built with React and TanStack (React Query) for data fetching and state management. The backend uses Node.js with Express.js to handle API requests, authentication, and data processing. SQLite serves as the lightweight, file-based database, initialized with pre-filled attendance data.

### Component Interaction

- **Frontend-Backend Communication**: The frontend communicates with the backend via REST API endpoints. REST is chosen for its simplicity, scalability, and stateless nature, which aligns well with the applicationâ€™s needs for real-time data filtering and graph rendering. WebSockets could be considered for future real-time updates but are unnecessary for the initial implementation.

- **Backend-Database Interaction**: The backend uses SQLite for persistent storage. SQLite is selected for its lightweight, serverless nature, and ease of integration within a Docker container. The database schema includes tables for attendance records, users, holidays, and non-working days.

- **Authentication Flow**: User authentication is handled via JWT tokens. Upon login, the backend validates credentials, generates a JWT, and returns it to the frontend. Subsequent API requests include this token for authorization. Passwords are securely hashed using bcryptjs before storage.

---

## Frontend Specifications

### Technology Stack

- **Framework**: React with Vite for fast development and bundling.  
- **Data Fetching & State Management**: TanStack (React Query) for efficient data fetching, caching, and state synchronization.  
- **Graphing Library**: Recharts for interactive and customizable charts (bar, pie, line).  
- **UI Components**: Custom-built components for filters, authentication forms, and data export/import controls.  
- **Responsive Design**: Ensures usability on desktop and mobile devices.

### Key Components

- **Dashboard with Graphs**: Interactive bar charts for attendance trends, pie charts for WFH vs. in-office distribution. Graphs are filterable by date range, employee ID, office location, and work mode.  
- **Data Filters**: Multi-select and date-range pickers for all database headers (Name, empid, date, etc.).  
- **Authentication System**: Login form with username/password, secure credential handling, and JWT-based session management.  
- **Export/Import Functionality**: UI controls to export attendance data to CSV/Excel and import data with validation against the database schema.

---

## Backend Specifications

### Technology Stack

- **Framework**: Node.js with Express.js for building RESTful API endpoints.  
- **Authentication**: JWT for stateless authentication, bcryptjs for password hashing.  
- **Database**: SQLite for persistent storage, initialized with pre-filled data.  
- **Validation**: Input validation and error handling for all endpoints.

### API Endpoints

- **Authentication**: `/api/auth/login`, `/api/auth/logout`, `/api/auth/validate` for session validation.  
- **Attendance CRUD**: `/api/attendance` with query parameters for filtering (e.g., `empid`, `startDate`, `endDate`).  
- **Data Export/Import**: Endpoints to handle CSV/Excel export and import with validation.  
- **User Roles**: Middleware to protect routes based on roles (admin/user).

---

## Database Schema

The database consists of four tables:

- **attendance**:  
  `Name (text)`, `empid (integer, unique)`, `date (date)`, `login_time (timestamp)`, `logout_time (timestamp)`, `office_location (text)`, `isWFH (boolean)`, `isInOffice (boolean)`, `seat_number (text)`, `office_floor (integer)`.

- **users**:  
  `id (primary key)`, `username (unique)`, `password_hash`, `role (admin/user)`.

- **holidays**:  
  `date (date, unique)`, `description (text)`.

- **non_working_days**:  
  `date (date, unique)`, `description (text)`.

---

## Docker Configuration

### Multi-Stage Dockerfile

The Dockerfile will:

1. Install Node.js and npm for frontend and backend dependencies.  
2. Copy and build the React frontend and Node.js backend code.  
3. Set up SQLite database initialization and pre-fill data using a seed script.  
4. Expose ports: `3000` for React frontend, `5000` for Express backend.  
5. Use a process manager like PM2 to run both frontend and backend servers simultaneously.  
6. Optimize image size by cleaning unnecessary files and leveraging layer caching.

### Docker Compose

A `compose.yml` file will define the services (frontend, backend, database) with bind mounts for hot reloading during development and persistent volumes for the database.

---

## Data Pre-Filling

A Python script using the Faker library will generate synthetic attendance data for 50 employees over 6 months, ensuring:

- Logical consistency (e.g., `logout_time` after `login_time`).  
- Variability in `office_location`, `seat_number`, `office_floor`.  
- Random but plausible login/logout times.  
- A mix of `isWFH` and `isInOffice` values.

This script initializes the SQLite database with realistic data, excluding holidays and non-working days, which remain empty for user population.

---

## Security Measures

- **Password Hashing**: bcryptjs for secure password storage.  
- **JWT Authentication**: Secure stateless sessions with token expiration.  
- **Environment Variables**: Sensitive data (e.g., secret keys) stored in `.env` files mounted into the container.  
- **Rate Limiting**: Protection against brute-force attacks on authentication endpoints.  
- **Input Validation**: Prevent SQL injection and XSS attacks.  
- **HTTPS**: Recommended for encrypting all client-server communication.

---

## Testing Plan

- **Unit Tests**: Jest or Pytest for backend endpoints and frontend components.  
- **Integration Tests**: API route testing with database interactions.  
- **End-to-End Tests**: Critical user flows (login, data filtering, export/import).  
- **Testing in Docker**: Ensure tests run inside the container to validate the full environment.

---

## Deployment Workflow

1. **Build Docker Image Locally**: `docker build -t attendance-app .`  
2. **Test Locally**: `docker compose up`  
3. **Push to Registry (Optional)**: `docker push attendance-app`  
4. **Run Container**: `docker run -p 3000:3000 -p 5000:5000 attendance-app`  
5. **Stop/Update/Restart**: Use Docker commands to manage the container lifecycle.

---

## Open-Ended Decisions

- **Backend Framework**: Node.js (Express) is preferred here, but Python (FastAPI/Flask) could be considered based on team expertise.  
- **Graphing Library**: Recharts is recommended, but Chart.js is also a viable alternative.  
- **Additional Features**: Attendance reports (PDF), notifications for late logins, and time zone handling (UTC vs. local time) are potential future enhancements.  
- **Database Choice**: SQLite is lightweight and suitable for a single container, but PostgreSQL with volumes could be used for more advanced scenarios.

---

## Summary Table: Tech Stack

| Component       | Technology / Library          | Description                          |
|----------------|-------------------------------|------------------------------------|
| Frontend       | React, TanStack (React Query) | UI, data fetching, state management|
| Graphing       | Recharts                      | Interactive charts and graphs       |
| Backend        | Node.js, Express.js           | REST API, authentication, CRUD     |
| Database       | SQLite                        | Lightweight, file-based database    |
| Authentication | JWT, bcryptjs                 | Secure user authentication          |
| Docker         | Multi-stage Dockerfile, Compose| Containerization and orchestration  |
| Data Export/Import | react-data-export, SpreadJS, Multer, GridFS | CSV/Excel export and import         |

---

## Timeline Estimate (Solo Developer, Moderate Experience)

| Phase                         | Estimated Duration | Notes                                  |
|------------------------------|--------------------|---------------------------------------|
| Environment Setup            | 1 day              | Docker, Node.js, React, SQLite setup |
| Frontend Development          | 3-4 days           | React components, TanStack integration|
| Backend Development           | 4-5 days           | Express API, authentication, CRUD     |
| Database Schema & Pre-filling | 1 day              | SQLite schema, Faker script           |
| Docker Configuration          | 1 day              | Multi-stage Dockerfile, Compose setup |
| Security Implementation       | 1 day              | JWT, bcrypt, environment variables    |
| Testing                      | 2 days             | Unit, integration, end-to-end tests   |
| Deployment Workflow           | 1 day              | Docker build, push, run commands      |
| **Total**                    | **14-16 days**     |                                        |

---

This comprehensive plan ensures a structured, secure, and scalable development and deployment process for the full-stack attendance tracking application packaged as a single Docker container.